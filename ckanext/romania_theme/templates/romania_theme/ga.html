<!-- Documentation is here https://ga-dev-tools.appspot.com/embed-api/basic-dashboard/ -->

{% extends "page.html" %}

{% block subtitle %}{{ _('Traffic Statistics') }}{% endblock %}

{% block breadcrumb_content %}
  <li class="active">{{ _('Traffic Statistics') }}</li>
{% endblock %}

{% block primary %}
  <article class="module">
    <div class="module-content">
          <h1 class="page-heading">{{ _('Traffic Statistics') }}</h1>

<script>
(function(w,d,s,g,js,fs){
  g=w.gapi||(w.gapi={});g.analytics={q:[],ready:function(f){this.q.push(f);}};
  js=d.createElement(s);fs=d.getElementsByTagName(s)[0];
  js.src='https://apis.google.com/js/platform.js';
  fs.parentNode.insertBefore(js,fs);js.onload=function(){g.load('analytics');};
}(window,document,'script'));
</script>

<h2>Over last year</h2>

<h3>Unique visitors</h3>
<div id="chart-1-container"></div>

<h3>Downloads and API calls</h3>
<div id="chart-4-container"></div>

<h3>Most downloaded resources</h3>
<div id="chart-2-container"></div>

<h3>Map</h3>
<div id="chart-3-container"></div>

<h2>Over last month</h2>

<h3>Unique visitors</h3>
<div id="chart-21-container"></div>

<h3>Downloads and API calls</h3>
<div id="chart-24-container"></div>

<h3>Most downloaded resources</h3>
<div id="chart-22-container"></div>

<h3>Map</h3>
<div id="chart-23-container"></div>

<script>

gapi.analytics.ready(function() {

  /**
   * Authorize the user with an access token obtained server side.
   */
  gapi.analytics.auth.authorize({
    'serverAuth': {
      'access_token': '{{token}}'
    }
  });

  var dataChart1 = new gapi.analytics.googleCharts.DataChart({
    query: {
      'ids': 'ga:78521092', // <-- Replace with the ids value for your view.
      'start-date': '30daysAgo',
      'end-date': 'yesterday',
      'metrics': 'ga:users',
      'dimensions': 'ga:date'
    },
    chart: {
      'container': 'chart-21-container',
      'type': 'LINE',
      'options': {
        'width': '100%'
      }
    }
  });
  dataChart1.execute();

  var dataChart4 = new gapi.analytics.googleCharts.DataChart({
    query: {
      'ids': 'ga:78521092', // <-- Replace with the ids value for your view.
      'start-date': '30daysAgo',
      'end-date': 'yesterday',
      'metrics': 'ga:totalEvents',
      'filters': 'ga:eventCategory=@Resource',
      'dimensions': 'ga:date'
    },
    chart: {
      'container': 'chart-24-container',
      'type': 'LINE',
      'options': {
        'width': '100%'
      }
    }
  });
  dataChart4.execute();

  var dataChart2 = new gapi.analytics.googleCharts.DataChart({
    query: {
      'ids': 'ga:78521092', // <-- Replace with the ids value for your view.
      'start-date': '30daysAgo',
      'end-date': 'yesterday',
      'metrics': 'ga:totalEvents',
      'dimensions': 'ga:eventLabel',
      'sort': '-ga:totalEvents',
      'filters': 'ga:eventCategory==Resource',
      'max-results': 20
    },
    chart: {
      'container': 'chart-22-container',
      'type': 'TABLE',
    }
  });
  dataChart2.execute();


  var dataChart3 = new gapi.analytics.googleCharts.DataChart({
    query: {
      'ids': 'ga:78521092',
      'dimensions': 'ga:country',
      'metrics': 'ga:sessions',
      'start-date': '30daysAgo',
      'end-date': 'yesterday',
    },
    chart: {
      type: 'GEO',
      container: 'chart-23-container'
    }
  });
  dataChart3.execute();

  // Yearly

  var dataChart1 = new gapi.analytics.googleCharts.DataChart({
    query: {
      'ids': 'ga:78521092', // <-- Replace with the ids value for your view.
      'start-date': '365daysAgo',
      'end-date': 'yesterday',
      'metrics': 'ga:users',
      'dimensions': 'ga:yearMonth'
    },
    chart: {
      'container': 'chart-1-container',
      'type': 'LINE',
      'options': {
        'width': '100%'
      }
    }
  });
  dataChart1.execute();

  var dataChart4 = new gapi.analytics.googleCharts.DataChart({
    query: {
      'ids': 'ga:78521092', // <-- Replace with the ids value for your view.
      'start-date': '365daysAgo',
      'end-date': 'yesterday',
      'metrics': 'ga:totalEvents',
      'filters': 'ga:eventCategory=@Resource',
      'dimensions': 'ga:yearMonth'
    },
    chart: {
      'container': 'chart-4-container',
      'type': 'LINE',
      'options': {
        'width': '100%'
      }
    }
  });
  dataChart4.execute();

  var dataChart2 = new gapi.analytics.googleCharts.DataChart({
    query: {
      'ids': 'ga:78521092', // <-- Replace with the ids value for your view.
      'start-date': '365daysAgo',
      'end-date': 'yesterday',
      'metrics': 'ga:totalEvents',
      'dimensions': 'ga:eventLabel',
      'sort': '-ga:totalEvents',
      'filters': 'ga:eventCategory==Resource',
      'max-results': 20
    },
    chart: {
      'container': 'chart-2-container',
      'type': 'TABLE',
    }
  });
  dataChart2.execute();


  var dataChart3 = new gapi.analytics.googleCharts.DataChart({
    query: {
      'ids': 'ga:78521092',
      'dimensions': 'ga:country',
      'metrics': 'ga:sessions',
      'start-date': '365daysAgo',
      'end-date': 'yesterday',
    },
    chart: {
      type: 'GEO',
      container: 'chart-3-container'
    }
  });
  dataChart3.execute();

});
</script>


    </div>
  </article>
{% endblock %}

{% block secondary %}{% endblock %}
